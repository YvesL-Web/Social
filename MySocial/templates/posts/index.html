{% extends 'base.html' %}
{% block title %} - Home{% endblock title %}
{% block content %}
{% comment %}
<div
  class="d-flex flex-column justify-content-center w-100 mx-auto mb-3"
  style="padding-top: 56px; max-width: 680px">
  {% include "partials/_messages.html" %}
  <!--stories card-->
  <div class="d-flex justify-content-between position-relative">
    <!--create story-->
    <div
      class="mx-1 bg-white rounded story"
      type="button"
      style="width: 6em; height: 190px">
      <img
        src="https://source.unsplash.com/collection/happy-people"
        alt="story post"
        class="card-img-top rounded"
        style="min-height: 125px; object-fit: cover" />
      <div
        class="d-flex align-items-center justify-content-center position-relative"
        style="min-height: 65px">
        <p class="m-0 text-center fs-7 fw-bold">Create Story</p>
        <div class="position-absolute top-0 start-50 translate-middle">
          <i
            class="fa-solid fa-circle-plus fs-3 text-primary bg-white p-1 rounded-circle"></i>
        </div>
      </div>
    </div>
    <!--others story-->
    <div
      class="rounded mx-1 story"
      type="button"
      style="width: 6em; height: 190px">
      <img
        src="https://source.unsplash.com/random/2"
        alt="other story"
        class="card-img-top rounded"
        style="min-height: 190px; object-fit: cover" />
    </div>
    <div
      class="rounded mx-1 story"
      type="button"
      style="width: 6em; height: 190px">
      <img
        src="https://source.unsplash.com/random/3"
        alt="other story"
        class="card-img-top rounded"
        style="min-height: 190px; object-fit: cover" />
    </div>
    <div
      class="rounded mx-1 story"
      type="button"
      style="width: 6em; height: 190px">
      <img
        src="https://source.unsplash.com/random/4"
        alt="other story"
        class="card-img-top rounded"
        style="min-height: 190px; object-fit: cover" />
    </div>
    <div
      class="rounded mx-1 story"
      type="button"
      style="width: 6em; height: 190px">
      <img
        src="https://source.unsplash.com/random/5"
        alt="other story"
        class="card-img-top rounded"
        style="min-height: 190px; object-fit: cover" />
    </div>
    <div
      class="d-none d-lg-block rounded mx-1 story"
      type="button"
      style="width: 6em; height: 190px">
      <img
        src="https://source.unsplash.com/random/6"
        alt="other story"
        class="card-img-top rounded"
        style="min-height: 190px; object-fit: cover" />
    </div>
    <!--next icon-->
    <div
      class="position-absolute top-50 start-100 translate-middle d-none d-lg-block">
      <i
        class="fa fa-arrow-right p-3 border text-muted bg-white rounded-circle"></i>
    </div>
  </div>
  <!--create post-->
  <div class="bg-white p-3 mt-3 rounded border shadow">
    <!--avatar-->
    <div class="d-flex" type="button">
      <div class="p-1">
        <img
          src="https://source.unsplash.com/collection/happy-people"
          alt="avatar"
          class="rounded-circle me-2"
          style="width: 38px; height: 38px; object-fit: cover" />
      </div>
      <input
        type="text"
        name=""
        id=""
        class="form-control rounded-pill border-0 bg-gray"
        placeholder="Tell us something, {{user.username}}..."
        disabled
        data-bs-toggle="modal"
        data-bs-target="#postModal" />
    </div>
    <!--create post modal-->
    <div
      class="modal fade"
      id="postModal"
      tabindex="-1"
      aria-labelledby="postModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <!--head-->
          <div class="modal-header align-items-center">
            <h1
              class="text-dark text-center w-100 m-0 fs-5"
              id="postModalLabel">
              Create Post
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"></button>
          </div>
          <!--body-->
          <div class="modal-body">
            <div class="my-1 p-1">
              <div class="d-flex flex-column">
                <!-- image&username-->
                <div class="d-flex align-items-center">
                  <!--avatar-->
                  <div class="p-2">
                    <img
                      src="{{user_profile.profile_img.url}}"
                      alt="avatar"
                      class="rounded-circle"
                      style="width: 38px; height: 38px; object-fit: cover" />
                  </div>
                  <!--username-->
                  <div>
                    <div>
                      <p class="m-0 fw-bold">{{user.username}}</p>
                    </div>
                  </div>
                </div>
                <form
                  action="{% url 'posts:upload' %}"
                  method="POST"
                  enctype="multipart/form-data">
                  {% csrf_token %}
                  <!--text-->
                  <div>
                    <textarea
                      placeholder="What's in your mind, {{user.username}}"
                      name="caption"
                      id=""
                      cols="30"
                      rows="2"
                      class="form-control border-0"></textarea>
                  </div>
                  <!--uppload image-->

                  <div class="mt-3">
                    <label for="recipient-name" class="col-form-label"
                      >Add Image/Video:</label
                    >
                    <input
                      name="image"
                      type="file"
                      accept="image/*"
                      class="form-control"
                      id="files" />
                  </div>

                  <!--footer-->
                  <div class="modal-footer p-0 mt-3">
                    <button type="submit" class="btn btn-primary w-100">
                      Post
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--actions-->
    <div class="d-flex flex-column flex-lg-row mt-3">
      <!--Photo-->
      <div
        class="d-flex align-items-center justify-content-center rounded dropdown-item"
        type="button">
        <i class="fa fa-photo-video me-2 text-success"></i>
        <p class="m-0 text-muted">Photo/Video</p>
      </div>
      <!--Activity/Feeling-->
      <div
        class="d-flex align-items-center justify-content-center rounded dropdown-item"
        type="button">
        <i class="fa fa-smile me-2 text-warning"></i>
        <p class="m-0 text-muted">Feeling/Activity</p>
      </div>
    </div>
  </div>
  <!--posts-->
  {% for post in posts %}

  <div class="bg-white p-4 rounded shadow mt-3">
    <!--author-->
    <div class="d-flex justify-content-between">
      <!--avatar-->
      <div class="d-flex">
        <img
          src="{{user_profile.profile_img.url}}"
          alt="avatar"
          class="rounded-circle me-2"
          style="width: 38px; height: 38px; object-fit: cover" />
        <div>
          <a href="#" class="m-0 fw-bold text-dark text-decoration-none"
            >{{post.user}}</a
          >
          <p class="text-muted fs-7">March 23 at 22:30</p>
        </div>
      </div>
      <!--edit-->
      <i
        class="fa fa-ellipsis-h"
        type="button"
        data-bs-toggle="dropdown"
        arial-expanded="false"
        id="postOption"></i>
      <!--edit menu-->
      <ul class="dropdown-menu border-0 shadow" aria-labelledby="postOption">
        <li class="d-flex align-items-center">
          <a
            href="#"
            class="dropdown-item d-flex align-items-center justify-content-around fs-7">
            Edit Post
          </a>
        </li>
        <li class="d-flex align-items-center">
          <a
            href="#"
            class="dropdown-item d-flex align-items-center justify-content-around fs-7">
            Delete Post
          </a>
        </li>
      </ul>
    </div>
    <!--post content-->
    <div class="mt-3">
      <!--content-->
      <div>
        <p>{{post.caption}}</p>
        <img src="{{post.image.url}}" alt="post img" class="img-fluid" />
      </div>
      <!--likes & comment-->
      <div class="position-relative mt-3 post__comment">
        <!--likes-->
        <div
          class="d-flex align-items-center position-absolute top-0 start-0"
          style="height: 50px; z-index: 5">
          <div class="me-2">
            <i class="fa fa-thumbs-up text-primary"></i>
          </div>
          <p class="m-0 text-mutedt fs-7" id="like_count">
            {{post.like_count}}
          </p>
        </div>
        <!--comment debut-->
        <div class="accordion" id="accordionExample">
          <div class="accordion-item border-0">
            <!--comment collapse-->
            <h2 class="accordion-header" id="headingOne">
              <div
                class="accordion-button collapsed d-flex justify-content-end"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#collapseComment"
                aria-expanded="true"
                aria-controls="collapseComment">
                <p class="m-0"></p>
              </div>
            </h2>
            <!--comment & likes bar-->
            <div class="d-flex justify-content-around">
              <!--comment-->
              <div
                class="d-flex align-items-center justify-content-center dropdown-item rounded text-muted p-1"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#collapseComment{{post.id}}"
                aria-expanded="true"
                aria-controls="collapseComment{{post.id}}">
                <a href="{% url 'posts:single_post' post.id %}"
                  ><i class="fa fa-comment-alt me-3"></i
                ></a>
                <p class="m-0">Comment</p>
              </div>
            </div>
            <!--comment expand-->
            <div
              id="collapseComment{{post.id}}"
              class="accordion-collapse collapse show"
              aria-labelledby="headingOne"
              data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <!--comment-->
                {% for comment in comments %} {% if post.id == comment.post.id
                %}
                <div class="d-flex align-items-center my-1">
                  <!--avatar-->
                  <img
                    src="{{comment.post.user.userprofile.profile_img.url}}"
                    alt="avatar"
                    class="rounded-circle me-2"
                    style="width: 38px; height: 38px; object-fit: cover" />
                  <!--comment text-->
                  <div class="p-3 rounded w-100 comment__input">
                    <!--menu-->
                    <div class="d-flex justify-content-end">
                      <i
                        class="fa fa-ellipsis-h"
                        type="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"></i>

                      <ul
                        class="dropdown-menu border-0 shadow"
                        aria-labelledby="postOption">
                        <li class="d-flex align-items-center">
                          <a
                            href="#"
                            class="dropdown-item d-flex align-items-center justify-content-around fs-7">
                            Edit Comment
                          </a>
                        </li>
                        <li class="d-flex align-items-center">
                          <a
                            href="#"
                            class="dropdown-item d-flex align-items-center justify-content-around fs-7">
                            Delete Comment
                          </a>
                        </li>
                      </ul>
                    </div>
                    <!--text-->
                    <p class="fw-bold m-0">{{comment.user}}</p>
                    <p class="text-muted fs-7">{{comment.created_at}}</p>
                    <p class="m-0 fs-7 bg-gray p-2 rounded-pill">
                      {{comment.body}}
                    </p>
                  </div>
                </div>
                {% endif %} {% endfor %}

                <!--create comment-->
                <div class="d-flex my-1">
                  <!--avatar-->
                  <div>
                    <img
                      src="https://source.unsplash.com/collection/happy-people"
                      alt="avatar"
                      class="rounded-circle me-2"
                      style="width: 38px; height: 38px; object-fit: cover" />
                  </div>
                  <!--input-->
                  <input
                    type="text"
                    name=""
                    id=""
                    class="form-control border-0 rounded-pill bg-gray"
                    placeholder="Write a comment" />
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--end accordion-->
      </div>
    </div>
  </div>

  {% endfor %}
</div>
{% endcomment %}

<div class="middle">
  {% include "partials/_messages.html" %}
  <!-- stories section -->
  <div class="stories d-flex justify-content-between" style="height: 12rem">
    <div
      class="story rounded p-1 mx-2 d-flex flex-column bg-info justify-content-between align-items-center text-white fs-7 position-relative overflow-hidden"
      style="
        width: 100%;
        background: url('https://source.unsplash.com/collection/10') no-repeat center
          center/cover;
      ">
      <div>
        <img
          class="profile-photo rounded-circle border border-2 border-light"
          style="width: 38px; height: 38px; object-fit: cover"
          src="https://source.unsplash.com/collection/happy-people/2"
          alt="" />
      </div>
      <p class="name">John Doe</p>
    </div>
    <div
      class="story rounded p-1 mx-2 d-flex flex-column bg-info justify-content-between align-items-center text-white fs-7 position-relative overflow-hidden"
      style="
        width: 100%;
        background: url('https://source.unsplash.com/collection/20') no-repeat center
          center/cover;
      ">
      <div>
        <img
          class="profile-photo rounded-circle border border-2 border-light"
          style="width: 38px; height: 38px; object-fit: cover"
          src="https://source.unsplash.com/collection/happy-people/3"
          alt="" />
      </div>
      <p class="name">Robin Stark</p>
    </div>
    <div
      class="story rounded p-1 mx-2 d-flex flex-column bg-info justify-content-between align-items-center text-white fs-7 position-relative overflow-hidden"
      style="
        width: 100%;
        background: url('https://source.unsplash.com/collection/3') no-repeat center
          center/cover;
      ">
      <div>
        <img
          class="profile-photo rounded-circle border border-2 border-light"
          style="width: 38px; height: 38px; object-fit: cover"
          src="https://source.unsplash.com/collection/happy-people/1"
          alt="" />
      </div>
      <p class="name">Elza Markess</p>
    </div>
    <!-- end stories -->
  </div>
  <!--create post section-->
  <div class="bg-white p-3 mt-3 rounded-pill border shadow">
    <!--avatar-->
    <div class="d-flex" type="button">
      <div class="p-1">
        <img
          src="https://source.unsplash.com/collection/happy-people"
          alt="avatar"
          class="rounded-circle me-2"
          style="width: 40px; height: 40px; object-fit: cover" />
      </div>
      <input
        type="text"
        name=""
        id=""
        class="form-control rounded-pill border-0 bg-gray"
        placeholder="Tell us something, {{user.username}}..."
        disabled
        data-bs-toggle="modal"
        data-bs-target="#postModal" />
    </div>
    <!--create post modal-->
    <div
      class="modal fade"
      id="postModal"
      tabindex="-1"
      aria-labelledby="postModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <!--head-->
          <div class="modal-header align-items-center">
            <h1
              class="text-dark text-center w-100 m-0 fs-5"
              id="postModalLabel">
              Create Post
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"></button>
          </div>
          <!--body-->
          <div class="modal-body">
            <div class="my-1 p-1">
              <div class="d-flex flex-column">
                <!-- image&username-->
                <div class="d-flex align-items-center">
                  <!--avatar-->
                  <div class="p-2">
                    <img
                      src="{{user_profile.profile_img.url}}"
                      alt="avatar"
                      class="rounded-circle"
                      style="width: 38px; height: 38px; object-fit: cover" />
                  </div>
                  <!--username-->
                  <div>
                    <div>
                      <p class="m-0 fw-bold">{{user.username}}</p>
                    </div>
                  </div>
                </div>
                <form
                  action="{% url 'posts:upload' %}"
                  method="POST"
                  enctype="multipart/form-data">
                  {% csrf_token %}
                  <!--text-->
                  <div>
                    <textarea
                      placeholder="What's in your mind, {{user.username}}"
                      name="caption"
                      id=""
                      cols="30"
                      rows="2"
                      class="form-control border-0"></textarea>
                  </div>
                  <!--uppload image-->

                  <div class="mt-3">
                    <label for="recipient-name" class="col-form-label"
                      >Add Image/Video:</label
                    >
                    <input
                      name="image"
                      type="file"
                      accept="image/*"
                      class="form-control"
                      id="files" />
                  </div>

                  <!--footer-->
                  <div class="modal-footer p-0 mt-3">
                    <button type="submit" class="btn btn-primary w-100">
                      Post
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- single post section -->
  {% for post in posts %}
  <div class="feeds my-4">
    <div class="feed bg-white rounded m-2 p-2">
      <div class="head d-flex justify-content-between">
        <div class="user d-flex gap-2">
          <div class="profile-photo">
            <img
              src="{{post.user.userprofile.profile_img.url}}"
              class="rounded-circle"
              style="width: 50px; height: 50px; object-fit: cover"
              alt="" />
          </div>
          <div class="ingo">
            <h3 class="fs-7">{{post.user}}</h3>
            <small>{{post.created_at}}</small>
          </div>
        </div>
        {% if request.user != post.user %} {% else %}
        <div class="dropdown">
          <span
            class="edit "
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false">
            <i class="fa-solid fa-ellipsis"></i>
          </span>
          <ul class="dropdown-menu rounded ">
            <li><a class="dropdown-item " href="#"><i class="fa-solid fa-pen-to-square text-info"></i> Edit</a></li>
            <li><a class="dropdown-item " href="{% url 'posts:delete_post' post.id %}"><i class="fa-solid fa-trash text-danger"></i> Delete</a></li>
          </ul>
        </div>
        {% endif %}
      </div>
      <div class="photo rounded overflow-hidden my-1 mx-0">
        <img
          src="{{post.image.url}}"
          style="height: 700px; width: 1200px; object-fit: cover"
          alt="" />
      </div>
      <!-- icon -->
      <div
        class="action-button d-flex justify-content-between align-items-center fs-4 m-2">
        <div class="interaction-button">
          <span>
            {% if post.likes.user == request.user  %}
            <i class="fa-regular fa-heart  text-danger"></i>
            {% else %}
            <i class="fa-regular fa-heart"></i>
            {% endif %}
          </span>
          <span><i class="fa-brands fa-rocketchat"></i></span>
        </div>
        <div class="bookmark">
          <span><i class="fa-regular fa-bookmark"></i></span>
        </div>
      </div>
      <!-- person who like the post -->
      <div class="liked-by d-flex align-items-center">
        <span
          class="d-block overflow-hidden border border-2 border-light rounded-circle"
          style="width: 38px; height: 38px; object-fit: cover">
          <img
            src="https://source.unsplash.com/collection/happy-people/1"
            alt="" />
        </span>

        <span
          class="d-block overflow-hidden border border-2 border-light rounded-circle"
          style="width: 38px; height: 38px; object-fit: cover">
          <img
            src="https://source.unsplash.com/collection/happy-people/2"
            alt="" />
        </span>

        <p class="mt-3 ms-1">
          liked by {{post.like_count}} user
        </p>
      </div>
      <div class="cpation">
        <p>
          <b>@{{post.user}}</b> <span class="fs-5">{{post.caption}}</span>
        </p>
      </div>
      <div>
        <a
          href="{% url 'posts:single_post' post.id %}"
          class="text-muted text-decoration-none text-decoration-underline"
          ><span class="text-dark text-muted">View all Comments</span>
        </a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock content %}
